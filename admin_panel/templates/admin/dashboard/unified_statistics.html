{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Å–µ—Ö –∫–∞—Å–∞–Ω–∏–π{% endblock %}

{% block content %}
<div class="container-fluid">
    <h1>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤—Å–µ—Ö –∫–∞—Å–∞–Ω–∏–π</h1>
    
    <!-- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
    <div class="row mb-4">
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">üåÖ –£—Ç—Ä–µ–Ω–Ω–∏–µ –∫–∞—Å–∞–Ω–∏—è</h5>
                    <h2>{{ touch_answers_by_type.morning }}</h2>
                    <small class="text-muted">–ó–∞ –Ω–µ–¥–µ–ª—é: {{ touch_answers_week_morning }}</small>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">üåû –î–Ω–µ–≤–Ω—ã–µ –∫–∞—Å–∞–Ω–∏—è</h5>
                    <h2>{{ touch_answers_by_type.day }}</h2>
                    <small class="text-muted">–ó–∞ –Ω–µ–¥–µ–ª—é: {{ touch_answers_week_day }}</small>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">üåô –í–µ—á–µ—Ä–Ω–∏–µ –∫–∞—Å–∞–Ω–∏—è</h5>
                    <h2>{{ touch_answers_by_type.evening }}</h2>
                    <small class="text-muted">–ó–∞ –Ω–µ–¥–µ–ª—é: {{ touch_answers_week_evening }}</small>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">üìÖ –°—Ç—Ä–∞—Ç—Å—É–±–±–æ—Ç—ã</h5>
                    <h2>{{ saturday_reflections_count }}</h2>
                    <small class="text-muted">–ó–∞ –Ω–µ–¥–µ–ª—é: {{ saturday_reflections_week }}</small>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–µ—á–µ—Ä–Ω–∏—Ö –æ—Ü–µ–Ω–æ–∫ -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">üìà –í–µ—á–µ—Ä–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏</h5>
                    <div class="row">
                        <div class="col-md-3">
                            <strong>–í—Å–µ–≥–æ –æ—Ü–µ–Ω–æ–∫:</strong> {{ evening_ratings_count }}
                            <br><small class="text-muted">–ó–∞ –Ω–µ–¥–µ–ª—é: {{ evening_ratings_week }}</small>
                        </div>
                        <div class="col-md-3">
                            <strong>–°—Ä–µ–¥–Ω—è—è —ç–Ω–µ—Ä–≥–∏—è:</strong> {{ avg_energy }}/10
                        </div>
                        <div class="col-md-3">
                            <strong>–°—Ä–µ–¥–Ω–µ–µ —Å—á–∞—Å—Ç—å–µ:</strong> {{ avg_happiness }}/10
                        </div>
                        <div class="col-md-3">
                            <strong>–°—Ä–µ–¥–Ω–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å:</strong> {{ avg_progress }}/10
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∫–∞—Å–∞–Ω–∏—è -->
    <div class="row mb-4">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5>üìù –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—Ç–≤–µ—Ç—ã –Ω–∞ –∫–∞—Å–∞–Ω–∏—è (–≤—Å–µ —Ç–∏–ø—ã)</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                    <th>–¢–∏–ø –∫–∞—Å–∞–Ω–∏—è</th>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–í–æ–ø—Ä–æ—Å</th>
                                    <th>–û—Ç–≤–µ—Ç</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for answer in recent_touch_answers %}
                                <tr>
                                    <td>{{ answer.user }}</td>
                                    <td>{{ answer.touch_content.get_touch_type_display }}</td>
                                    <td>{{ answer.touch_date|date:"d.m.Y" }}</td>
                                    <td>–í–æ–ø—Ä–æ—Å {{ answer.question_number }}</td>
                                    <td>{{ answer.answer_text|truncatewords:10 }}</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="5" class="text-center">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—á–µ—Ä–Ω–∏–µ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>üåô –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—á–µ—Ä–Ω–∏–µ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–†–µ—Ñ–ª–µ–∫—Å–∏—è</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for reflection in recent_evening_reflections %}
                                <tr>
                                    <td>{{ reflection.user }}</td>
                                    <td>{{ reflection.reflection_date|date:"d.m.Y" }}</td>
                                    <td>{{ reflection.reflection_text|truncatewords:15 }}</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="3" class="text-center">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—á–µ—Ä–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏ -->
        <div class="col-md-6">
            <div class="card">
                <div class="card-header">
                    <h5>‚≠ê –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤–µ—á–µ—Ä–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–≠–Ω–µ—Ä–≥–∏—è</th>
                                    <th>–°—á–∞—Å—Ç—å–µ</th>
                                    <th>–ü—Ä–æ–≥—Ä–µ—Å—Å</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for rating in recent_evening_ratings %}
                                <tr>
                                    <td>{{ rating.user }}</td>
                                    <td>{{ rating.rating_date|date:"d.m.Y" }}</td>
                                    <td>{{ rating.rating_energy }}</td>
                                    <td>{{ rating.rating_happiness }}</td>
                                    <td>{{ rating.rating_progress }}</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="5" class="text-center">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ —Å—Ç—Ä–∞—Ç—Å—É–±–±–æ—Ç—ã -->
    <div class="row">
        <div class="col-md-12">
            <div class="card">
                <div class="card-header">
                    <h5>üìÖ –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Ä–µ—Ñ–ª–µ–∫—Å–∏–∏ —Å—Ç—Ä–∞—Ç—Å—É–±–±–æ—Ç—ã</h5>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</th>
                                    <th>–î–∞—Ç–∞</th>
                                    <th>–ó–∞–ø–æ–ª–Ω–µ–Ω–æ —Å–µ–≥–º–µ–Ω—Ç–æ–≤</th>
                                </tr>
                            </thead>
                            <tbody>
                                {% for reflection in recent_saturday_reflections %}
                                <tr>
                                    <td>{{ reflection.user }}</td>
                                    <td>{{ reflection.reflection_date|date:"d.m.Y" }}</td>
                                    <td>{{ reflection.segments_completed }}/5</td>
                                </tr>
                                {% empty %}
                                <tr>
                                    <td colspan="3" class="text-center">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

